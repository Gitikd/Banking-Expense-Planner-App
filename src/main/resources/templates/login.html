<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>Login - VisionWallet</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
	<style>
	  :root {
	    --peach: #FFF2E0;
	    --lavender-light: #C0C9EE;
	    --lavender: #A2AADB;
	    --lavender-dark: #898AC4;
	  }

	body {
	  margin: 0;
	  padding: 0;
	  height: 100vh;
	  background: linear-gradient(135deg, #FFF2E0 0%, #C0C9EE 40%, #A2AADB 75%, #898AC4 100%);
	  font-family: 'Segoe UI', sans-serif;
	  display: flex;
	  justify-content: center;
	  align-items: center;
	  position: relative;
	  overflow: hidden;
	}
	body::after {
	  content: '';
	  position: absolute;
	  inset: 0;
	  background-image: url('https://www.transparenttextures.com/patterns/soft-wallpaper.png'); /* texture */
	  opacity: 0.06;
	  pointer-events: none;
	}



	.fixed-logo {
	  position: absolute;
	  top: 20px;
	  left: 30px;
	  z-index: 10;
	}

	.big-logo {
	  height: 100px;  /* You can increase this if needed */
	  width: auto;
	  border-radius: 20px;
	}


	  .logo {
	    position: absolute;
	    top: 20px;
	    left: 20px;
	  }

	  .rounded-logo {
	    height: 60px;
	    object-fit: cover;
	    border-radius: 1rem;
	  }

		.login-card {
		  background: rgba(255, 255, 255, 0.85); /* brighter for contrast */
		  backdrop-filter: blur(18px);
		  color: #333;
		  border-radius: 20px;
		  padding: 40px 30px;
		  max-width: 400px;
		  width: 100%;
		  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
		  border: 1px solid rgba(255, 255, 255, 0.4);
		}


		.emoji-lock {
		  text-align: center;  /* center contents inside */
		  margin-bottom: 10px;
		}

		.fa-solid.fa-user-lock {
		  font-size: 42px;
		  color: #A2AADB;
		}



	  h2 {
	    text-align: center;
	    font-weight: 800;
	    font-size: 28px;
	    color: var(--lavender-dark);
	    margin-bottom: 20px;
	  }

	label {
	  font-weight: 500;
	  margin-bottom: 5px;
	  color: #444; /* darker for contrast */
	}

	.form-icon {
	  margin-right: 8px;
	  color: #555; /* icons more visible */
	}

	.input-group-text {
	  background: #f0f0f0;
	  border: none;
	  color: #333;
	}


	  .form-control {
	    border-radius: 12px;
	    padding: 12px 15px;
	    font-size: 16px;
	    border: none;
	    box-shadow: inset 0 0 5px rgba(0, 0, 0, 0.1);
	  }

	  .password-group {
	    border-radius: 12px;
	    overflow: hidden;
	  }

	  .password-group .input-group-text {
	    background: var(--lavender-light);
	    border: none;
	    cursor: pointer;
	    padding: 0 12px;
	    color: #333;
	  }

	.btn-login {
	  background: linear-gradient(135deg, #898AC4, #A2AADB);
	  border: none;
	  border-radius: 14px;
	  font-size: 18px;
	  padding: 12px;
	  margin-top: 20px;
	  color: #fff;
	  font-weight: 600;
	  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
	  transition: transform 0.2s ease, background 0.3s ease;
	}
	.btn-login:hover {
	  background: linear-gradient(135deg, #A2AADB, #898AC4);
	  transform: scale(1.02);
	}


		.form-text {
		  text-align: center;
		  margin-top: 16px;
		  color: #444; /* darker text for better visibility */
		  font-size: 15px;
		}

		.form-text a {
		  color: #5e63c3; /* soft violet link */
		  text-decoration: none;
		  font-weight: 600;
		}

		.form-text a:hover {
		  text-decoration: underline;
		  color: #3d3fa0;
		}


	  .form-icon {
	    margin-right: 8px;
	    color: var(--lavender-light);
	  }

	  input:focus {
	    outline: 2px solid var(--lavender);
	    box-shadow: 0 0 0 0.15rem var(--lavender-light);
	  }
	</style>

</head>
<body>

<!-- Logo at Top-Left -->
<div class="fixed-logo">
  <img src="/images/VisionWallet.png" alt="VisionWallet Logo" class="big-logo">
</div>



<!-- Login Card -->
<div class="login-card">
	<div class="emoji-lock">
	  <i class="fa-solid fa-user-lock"></i>
	</div>
	<h2 class="login-title">Login</h2>


<form id="loginForm" class="mt-4">
  <div class="mb-3">
    <label><i class="fas fa-envelope form-icon"></i>Email</label>
    <input type="email" class="form-control" id="loginEmail" placeholder="Enter your email" required>
  </div>

  <div class="mb-3">
    <label><i class="fas fa-lock form-icon"></i>Password</label>
    <div class="input-group password-group">
      <input type="password" id="password" class="form-control" placeholder="Enter your password" required>
      <span class="input-group-text toggle-password" onclick="togglePassword()">
        <i class="fa-solid fa-eye" id="eyeIcon"></i>
      </span>
    </div>
  </div>

  <button type="submit" class="btn btn-login w-100">
    <i class="fas fa-sign-in-alt me-2"></i>Login
  </button>

  <div class="form-text">
    Donâ€™t have an account? <a href="/register"><i class="fas fa-user-plus"></i> Register</a>
  </div>
</form>
</div>

<script src="https://unpkg.com/@dotlottie/player-component@2.7.12/dist/dotlottie-player.mjs" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>


<script>
  // ðŸ‘ Toggle Password Visibility
  function togglePassword() {
    const passwordInput = document.getElementById("password");
    const icon = document.getElementById("eyeIcon");

    const isPassword = passwordInput.getAttribute("type") === "password";
    passwordInput.setAttribute("type", isPassword ? "text" : "password");

    icon.classList.toggle("fa-eye");
    icon.classList.toggle("fa-eye-slash");
  }

  // ðŸ” Handle Login Form Submission
  document.getElementById("loginForm").addEventListener("submit", async function (e) {
    e.preventDefault();

    const email = document.getElementById("loginEmail").value;
    const password = document.getElementById("password").value;

    const res = await fetch("/api/users/login", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ email, password })
    });

    const data = await res.text();

    // Hide login card
    const loginCard = document.querySelector(".login-card");
    loginCard.style.display = "none";

    // Prepare animation container
    const animationContainer = document.createElement("div");
    animationContainer.style.textAlign = "center";

    const message = document.createElement("h5");
    message.classList.add("mt-3");

    const lottie = document.createElement("dotlottie-player");
    lottie.setAttribute("background", "transparent");
    lottie.setAttribute("speed", "1");
    lottie.setAttribute("style", "width: 300px; height: 300px;");
    lottie.setAttribute("loop", "");
    lottie.setAttribute("autoplay", "");

    if (data.startsWith("Bearer ")) {
      localStorage.setItem("jwt", data.substring(7));

      // âœ… Success animation
      lottie.setAttribute("src", "https://lottie.host/5507ae3d-8280-477a-b306-a91eecedeb22/zzeAwAcgvk.lottie");
      message.textContent = "Login successful! Redirecting...";
      message.classList.add("text-success");

      document.body.appendChild(animationContainer);
      animationContainer.appendChild(lottie);
      animationContainer.appendChild(message);

      setTimeout(() => {
        localStorage.setItem("showReminders", "true"); // âœ… flag for dashboard reminders
        window.location.href = "/dashboard";
      }, 5000);

    } else {
      // âŒ Failure animation
      lottie.setAttribute("src", "https://lottie.host/a37c195f-6d02-464a-999e-95b906b51ad5/NLu4LfflJC.lottie");
      message.textContent = "Login failed! Please try again.";
      message.classList.add("text-danger");

      document.body.appendChild(animationContainer);
      animationContainer.appendChild(lottie);
      animationContainer.appendChild(message);

      // Optionally, allow retry
      setTimeout(() => {
        window.location.reload(); // Reload form after 5 sec
      }, 2500);
    }
  });
</script>



</body>
</html>
